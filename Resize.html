<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<!-- Using this metatag users can't scale the page using pinchIn/out gestures on mobile devices -->
	<meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">

	<script src="https://code.createjs.com/easeljs-0.8.1.min.js"></script>
	<script src="https://code.createjs.com/preloadjs-0.6.1.min.js"></script>
	<script src="https://code.createjs.com/soundjs-0.6.1.min.js"></script>
	
	<title>EaselJS demo: Resize</title>	

	<style type="text/css">

		/* Remove margins and HTML scrollbars */
		BODY, HTML  {
			margin: 0;
			padding: 0;
			overflow: hidden;
		}
	</style>
<!--	
<header class="CreateJS">
	<h1>Resize Example</h1>
	
	<p>This example is used to show how to resize images in CreateJS.</p>
</header>
	-->
	


</head>
<body onLoad="init();">
	<canvas id="demoCanvas" width="800" height="600"  >
		alternate content
	</canvas>
	
	<!-- Not sure why but cannot have Javascript outside of the body -->
	
	<script>

		var stage;
		var bg, logo;		
		var content, storyImg;
		var imgPath = "Story_Images/";

		// Resize event listener
		window.addEventListener('resize', resize);

		/**
		 * Init handler
		 */
		function init() {

			stage = new createjs.Stage("demoCanvas");
			
			createBackground();
			createLogo();
			createContent();
			//alert("set up ticker");
			
			/*BUG*/ //Does not progress from this point on.
			//createjs.Ticker.addListener(this);
			createjs.Ticker.addEventListener("tick", tick);
			/**
			 * Tick Handler
			 */
			function tick() {
				stage.update();
				//alert("tick");
			}
			
			//alert("ticker added");
			resize();
			//alert("resize complete");
		}
		
		/**
		 * create and display the background (fullscreen)
		 */
		function createBackground() {
			
			bg = new createjs.Shape();		
			stage.addChild(bg);

		}

		/**
		 * create and display logo (top-right)
		 */
		function createLogo() {

			logo = new createjs.Bitmap(imgPath + "echo2.png");
			logo.y = 10;
			stage.addChild(logo);

		}
		
		 
		/**
		 * create content (centered)
		 */
		function createContent() {


			content = new createjs.Container();
			stage.addChild(content);

			// Load the Image
			// (You should also use PreloadJS to avoid the onload listener)
			storyImg = new Image();
			storyImg.src = imgPath +"web_voice_v2-01.jpg";
			storyImg.onload = handleImageLoad;
			//alert("image loaded");

		}
		
		function handleImageLoad() {

			// Create a CreateJS bitmap from the loaded image
			var bmpStoryImage = new createjs.Bitmap(storyImg);

			// Add the bitmap to the Container
			content.addChild(bmpStoryImage);
			
			// Set the registration point of the content Container to center
			content.regX = bmpStoryImage.image.width/2;
			content.regY = bmpStoryImage.image.height/2;

			// Set the scale value
			// It could be useful to properly handle different mobile resolutions
			content.scaleX = 0.5;
			content.scaleY = 0.5;
			//alert("scaling set");
			
			/*BUG*/ //This method of setting the transform does not work
			//content.setTransform(0,0, 0.5, 0.5, 0,0,0,0,0);
			
		}


		/**
		 * Tick Handler
		 */
		/*function tick() {
			
			stage.update();
			alert("tick");
		}*/	
			
		/**
		 * Resize event handler
		 */
		function resize() {
			//alert("resize");
			/*
			// First method attempting to use the Container content for resize
			// Resize the canvas element
		  	stage.canvas.width = window.innerWidth;
	    	stage.canvas.height = window.innerHeight;	    	

	    	// Logo: top-right position (canvasWidth - image width - 10 px padding)
	    	logo.x = stage.canvas.width - 400 - 10

	    	// Background: full screen redraw 
	    	bg.graphics.clear()
	    	bg.graphics.beginFill("#222").drawRect(0, 0, stage.canvas.width, stage.canvas.height);
	    	
	        // Content: centered
	        content.x = stage.canvas.width / 2;
	        content.y = stage.canvas.height / 2;
			//alert("resize complete");
			*/
			
			/*
			// Possible alternative method that simply involves updating the dimensions of the canvas
			// just showing width to simplify the example:
			var newWidth = 600;
			var newHeight = 400;
			var scale = newWidth/demoCanvas.width;
			demoCanvas.width = newWidth;
			stage.scaleX = stage.scaleY = scale;			
			
			// Background: full screen redraw 
	    	bg.graphics.clear()
	    	bg.graphics.beginFill("#222").drawRect(0, 0, stage.canvas.width, stage.canvas.height);
			
			// Content: centered
	        content.x = stage.canvas.width / 2;
	        content.y = stage.canvas.height / 2;
			
			stage.update(); // draw at the new size.
			*/
			
			// Additional scaling method based of the content container
			//var w = $("#container").width();
			//var h = $("#container").height();
			
			var w = window.innerWidth-2;
			var h = window.innerHeight-2;

			stage.canvas.width = w;
			stage.canvas.height = h;

			// Simple "fit-to-screen" scaling
			var ratio = 1667 / 1250; // Use the "default" size of the content you have.
			var windowRatio = w/h;
			var scale = w/1250;
			if (windowRatio > ratio) {
				scale = h/1667;
			}
			
			// Background: full screen redraw 
	    	bg.graphics.clear()
	    	bg.graphics.beginFill("#222").drawRect(0, 0, stage.canvas.width, stage.canvas.height);
			
			// Content: centered
	        content.x = stage.canvas.width / 2;
	        content.y = stage.canvas.height / 2;
			
			// Scale up to fit width or height
			content.scaleX = content.scaleY = scale;
			
			stage.update();
		
	    }

	</script>
</body>
</html>